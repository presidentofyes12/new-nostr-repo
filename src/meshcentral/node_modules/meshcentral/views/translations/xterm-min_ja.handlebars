<!doctypehtml><html dir=ltr xmlns=http://www.w3.org/1999/xhtml><head lang=en><meta http-equiv=X-UA-Compatible content="IE=edge"><meta content="text/html;charset=utf-8"http-equiv=Content-Type><meta name=viewport content="user-scalable=1,initial-scale=1,minimum-scale=1,maximum-scale=1"><meta name=apple-mobile-web-app-capable content=yes><meta name=format-detection content="telephone=no"><meta name=robots content=noindex,nofollow><link type=text/css href=styles/style.css media=screen rel=stylesheet title=CSS><link type=text/css href=styles/xterm.css media=screen rel=stylesheet title=CSS><link rel=apple-touch-icon href=/favicon-303x303.png><script src=scripts/common-0.0.1{{min}}.js></script><script src=scripts/meshcentral{{min}}.js></script><script src=scripts/agent-redir-ws-0.1.1{{min}}.js></script><script src=scripts/agent-redir-rtc-0.1.0{{min}}.js></script><script src=scripts/xterm-min.js></script><script src=scripts/xterm-addon-fit-min.js></script><title>{{{name}}}</title><body style=overflow:hidden;background-color:#000 oncontextmenu=handleContextMenu(event)><div id=termShellContextMenu class="contextMenu noselect"style=display:none;min-width:0><div id=cxtermnorm class=cmtext onclick=cmtermaction(1,event)><b>管理シェル</b></div><div id=cxtermps class=cmtext onclick=cmtermaction(6,event)>管理者PowerShell</div><div id=cxtermunorm class=cmtext onclick=cmtermaction(8,event)>ユーザーシェル</div><div id=cxtermups class=cmtext onclick=cmtermaction(9,event)>ユーザーPowerShell</div></div><div id=termShellContextMenuLinux class="contextMenu noselect"style=display:none;min-width:0><div id=cxtermnorm class=cmtext onclick=cmtermaction(1,event)><b>ルートシェル</b></div><div id=cxtermps class=cmtext onclick=cmtermaction(8,event)>ユーザーシェル</div><div id=cxtermps class=cmtext onclick=cmtermaction(100,event)>ログインシェル</div></div><div id=p11 class=noselect style=overflow:hidden><div id=deskarea0 style=position:relative><div id=deskarea1 class=areaHead><div class=toright2></div><div><input id=ConnectButton style=display:none type=button value=つなぐ onclick=connectButton()> <input id=DisconnectButton type=button value=切断する onclick=connectButton()> <span><b>{{{name}}}</b></span> - <span id=termstatus></span></div></div><div id=deskarea2><div class=areaProgress><div id=progressbar></div></div></div><div id=deskarea3x style="max-height:calc(100vh - 54px);height:calc(100vh - 54px)"><div id=bigok style="display:none;left:calc((100vh / 2))"><b>✓</b></div><div id=bigfail style="display:none;left:calc((100vh / 2))"><b>✗</b></div><div id=metadatadiv style=padding:20px;color:#d3d3d3;text-align:left;display:none></div><div id=terminal style="max-height:calc(100vh - 54px);height:calc(100vh - 54px)"></div><div id=TermConsoleMsg style=display:none;cursor:pointer;z-index:10;position:absolute;left:30px;top:17px;color:#ff0;background-color:rgba(0,0,0,.6);padding:10px;border-radius:5px onclick=clearConsoleMsg()></div></div><div id=deskarea4 class=areaHead><div class=toright2></div><div style=height:21px;max-height:21px></div></div></div><div id=dialog class=noselect style=display:none><div id=dialogHeader><div tabindex=0 id=id_dialogclose onclick=setDialogMode() onkeypress='"Enter"==event.key&&setDialogMode()'>✖</div><div id=id_dialogtitle></div></div><div id=dialogBody><div id=dialog1><div id=id_dialogMessage></div></div><div id=dialog2><div id=id_dialogOptions></div></div></div><div id=idx_dlgButtonBar><input id=idx_dlgCancelButton type=button value=キャンセル onclick=dialogclose(0)> <input id=idx_dlgOkButton type=button value=OK onclick=dialogclose(1)><div><input id=idx_dlgDeleteButton type=button value=削除する style=display:none onclick=dialogclose(2)></div></div></div></div><script>var random="{{{randomlength}}}",term=null,termfit=null,tunnel=null,domain="{{{domain}}}",domainUrl="{{{domainurl}}}",authCookie="{{{authCookie}}}",authRelayCookie="{{{authRelayCookie}}}",serverPublicNamePort="{{{serverDnsName}}}:{{{serverPublicPort}}}",StatusStrs=["切断されました","接続しています...","セットアップ...","接続済み","Intel&reg;接続されたAMT"],resizeTimer=null;function start(){(args=parseUriArgs()).key&&0==isAlphaNumeric(args.key)&&delete args.key,(meshserver=MeshServerCreateControl(domainUrl,authCookie)).onStateChanged=onStateChanged,meshserver.onMessage=onMessage,meshserver.trace=1==args.trace,meshserver.Start(),window.onresize=function(){null!=termfit&&termfit.fit()},document.onclick=function(e){hideContextMenu()},QH("termstatus",StatusStrs[0]),updateButtons()}function updateButtons(){var e=null!=tunnel&&0!=tunnel.state&&2==meshserver.State;QE("ConnectButton",2==meshserver.State),QV("ConnectButton",!e),QV("DisconnectButton",e)}function onStateChanged(e,t,n,o){QE("ConnectButton",2==t),2==t&&1==args.auto&&(delete args.auto,connectButton()),updateButtons()}function onMessage(e,t){}function CreateRemoteTunnel(e,t){var n={protocol:1};return null!=t&&"number"==typeof t.protocol&&(n.protocol=t.protocol),n.onTunnelUpdate=e,n.xxStateChange=function(e){},n.ProcessBinaryData=function(e){n.onTunnelUpdate(e)},n.ProcessData=function(e){n.onTunnelUpdate(e)},n}function sendResize(){(resizeTimer=null)!=term&&null!=tunnel&&tunnel.sendCtrlMsg(JSON.stringify({ctrlChannel:"102938",type:"termsize",cols:term.cols,rows:term.rows}))}function connectButton(e){tunnel?tunnel.Stop():(null!=term&&term.dispose(),1!=args.fixsize&&(termfit=new FitAddon.FitAddon),term=new Terminal,termfit&&term.loadAddon(termfit),term.open(Q("terminal")),term.onData(function(e){null!=tunnel&&tunnel.sendText(e)}),termfit&&termfit.fit(),term.onResize(function(e){resizeTimer&&clearTimeout(resizeTimer),resizeTimer=setTimeout(sendResize,200)}),(tunnel=CreateAgentRedirect(meshserver,CreateRemoteTunnel(tunnelUpdate,e),serverPublicNamePort,authCookie,authRelayCookie,domainUrl)).options={cols:term.cols,rows:term.rows},e&&e.requireLogin&&(tunnel.options.requireLogin=!0),tunnel.Start(args.nodeid),tunnel.onStateChanged=onTunnelStateChange,tunnel.onConsoleMessageChange=function(e,t){setConsoleMsg(t)})}function tunnelUpdate(e){term.writeUtf8?"string"==typeof e?term.writeUtf8(e):term.writeUtf8(new Uint8Array(e)):"string"==typeof e?term.write(e):term.write(new Uint8Array(e))}function onTunnelStateChange(e,t){var n=t,e=(3==n&&2==e.contype&&n++,StatusStrs[n]);switch(1==tunnel.webRtcActive&&(e+="、WebRTC"),QH("termstatus",e),t){case 0:term.dispose(),term=termfit=tunnel=null;break;case 3:term.focus()}updateButtons()}var termConsoleMsgTimer=null;function clearConsoleMsg(){QV("TermConsoleMsg",!1),termConsoleMsgTimer&&(clearTimeout(termConsoleMsgTimer),termConsoleMsgTimer=null)}function setConsoleMsg(e){QH("TermConsoleMsg",EscapeHtml(e).split("\n").join("<br />")),QV("TermConsoleMsg",!0),termConsoleMsgTimer=setTimeout(clearConsoleMsg,8e3)}var xxdialogMode,xxdialogFunc,xxdialogButtons,xxdialogTag,contextelement=null;function handleContextMenu(e){hideContextMenu();var t=null!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,n=null!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,t=document.elementFromPoint(e.pageX-t,e.pageY-n);if(t&&null!=t&&"ConnectButton"==t.id)return contextelement=t,showContextMenuDiv("win"==args.os?document.getElementById("termShellContextMenu"):document.getElementById("termShellContextMenuLinux"),e.pageX,e.pageY),haltEvent(e)}function showContextMenuDiv(e,t,n){var o=document.documentElement.getBoundingClientRect(),r=o.height,o=o.width;e.style.left=e.style.right=e.style.top=e.style.bottom=null,o/2<t?e.style.right=o-event.pageX+"px":e.style.left=event.pageX+"px",r/2<n?e.style.bottom=r-event.pageY+"px":e.style.top=event.pageY+"px",e.style.display="block"}function cmtermaction(e){e<100?connectButton({protocol:e}):100==e&&connectButton({protocol:1,requireLogin:!0})}function hideContextMenu(){QV("contextMenu",!1),QV("termShellContextMenu",!1),QV("termShellContextMenuLinux",!1),contextelement=null}var xxcurrentView=-1;function setDialogMode(e,t,n,o,r,i){xxdialogMode=e,xxdialogFunc=o,xxdialogButtons=n,xxdialogTag=i,QE("idx_dlgOkButton",!0),QV("idx_dlgOkButton",1&n),QV("idx_dlgCancelButton",2&n),QV("id_dialogclose",2&n||8&n),QV("idx_dlgDeleteButton",4&n),QV("idx_dlgButtonBar",7&n),t&&QH("id_dialogtitle",t);for(var l=1;l<3;l++)QV("dialog"+l,l==e);QV("dialog",e),r&&(2==e?QH("id_dialogOptions",r):QH("id_dialogMessage",r))}function dialogclose(e){var t=xxdialogFunc,n=xxdialogButtons,o=xxdialogTag;setDialogMode(),(8&n||e)&&t&&t(e,o)}function messagebox(e,t){setSessionActivity(),QH("id_dialogMessage",t),setDialogMode(1,e,1)}function statusbox(e,t){setSessionActivity(),QH("id_dialogMessage",t),setDialogMode(1,e)}function haltEvent(e){return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}function pad2(e){e="00"+e;return e.substr(e.length-2)}function format(e){var n=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,function(e,t){return void 0!==n[t]?n[t]:e})}function isAlphaNumeric(e){return null!=e.match(/^[A-Za-z0-9]+$/)}function isSafeString(e){return"string"==typeof e&&-1==e.indexOf("<")&&-1==e.indexOf(">")&&-1==e.indexOf("&")&&-1==e.indexOf('"')&&-1==e.indexOf("'")&&-1==e.indexOf("+")&&-1==e.indexOf("(")&&-1==e.indexOf(")")&&-1==e.indexOf("#")&&-1==e.indexOf("%")&&-1==e.indexOf(":")}function parseUriArgs(){var e,t,n=window.document.location.href,o={},r=(n=n.endsWith("#")?n.substring(0,n.length-1):n).split(/[\?&|\=]/);for(t in r.splice(0,1),r)switch(t%2){case 0:e=decodeURIComponent(r[t]);break;case 1:o[e]=decodeURIComponent(r[t]),isSafeString(o[e])?(t=parseInt(o[e]))==o[e]&&(o[e]=t):delete o[e]}return o}start()</script>